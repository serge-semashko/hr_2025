tab_boinus_otdel_table.cfg

[comments]
    descr=Таб "Премии" v2 редактирование in place
    input=none
    output=HTML таблица объектов
    parents=
    childs=admin/monitor/docs_list_table.cfg
    testURL=?c=admin/monitor/docs_list
    author:Семашко
[end]

[parameters]
    service=dubna.walt.service.TableServiceSpecial
    request_name=U:Список документов
    LOG=ON 
    tableCfg=table_no
    $INCLUDE dat/common.dat[rowLinks]
[end]

[fill otdelenie fonds]
  $GET_DATA SQL:select short_name as top_name from struktura where id=#TOP_DIV# 
  
  $LOG2 ======   BEGIN [ФОНДЫ ОТДЕЛЕНИЯ]   = #TOP_DIV# <span style="color:red;font-size:24">#top_name#</span> <br> ??
  $SET_PARAMETERS cur_otd_names=;  cur_otd_ids;
  $GET_DATA SQL:select concat(short_name,',') as cur_otd_names from struktura where pid=#TOP_DIV#  #strflt_s#
  $GET_DATA SQL:select concat(id,',') as cur_otd_ids from struktura where pid=#TOP_DIV#  #strflt_s#
  $IF !strflt_s
    $SET_PARAMETERS cur_otd_names=#top_name#,#cur_otd_names#;cur_otd_ids=#TOP_DIV#,#cur_otd_ids#; ??!TOP_DIV=189000&!TOP_DIV=195000
    $SET_PARAMETERS cur_otd_names=#top_name#,;cur_otd_ids=#TOP_DIV#,; ??TOP_DIV=189000|TOP_DIV=195000
  $EIF  
  $LOG2 ======= Select= cur_otd_names=#cur_otd_names# cur_otd_idss=#cur_otd_ids#<br> ??
  $JS_{
    var c_names = prm('cur_otd_names').split(',');
    c_names.pop();
    var c_ids = prm('cur_otd_ids').split(',');
    c_ids.pop();
    var brd_style=' style="border-left:1px black;border-right;1px black;"';
     var sub_div_table ='<div id=fond_sub_'+prm('TOP_DIV')+ ' style=\'display:none\' ><table border=0 cellpadding=1 cellspacing=0><tr>';
    for (var i = 0;i<c_ids.length;i++ ) {
        var div_id=c_ids[i];
        _$LOG(2,'********************** DIV = '+c_names[i]+'  = '+c_ids[i]+'<br>'); ??
        setPrm('fond_summ','0');
        setPrm('got_fond','0');
        setPrm('jinr_distr','0');
        setPrm('SOC_summ','0');
        setPrm('SOC_fond','0');
        setPrm('other_summ','0');
        setPrm('other_fond','0');
        setPrm('fond_summ_prev','0');
        setPrm('got_fond_prev','0');
/*
        _$GET_DATA("SQL:select ifnull(summa,0) as fond_summ from bonus_fond where month="+prm('selected_month')+ " and year="+prm('selected_year')+
            " and ist_id<100 and ist_div="+div_id );

        _$GET_DATA("SQL:select ifnull(summa,0) as jinr_distr from bonus_fond where month="+prm('selected_month')+ " and year="+prm('selected_year')+
            " and ist_id=4000 and ist_div="+div_id );


        _$GET_DATA("SQL:select ifnull(sum(summa),0) as got_fond  from lit_bonus_v0 where month="+prm('selected_month')+ " and year="+prm('selected_year')+
            " and ist_id<100 and ist_div="+div_id );

        _$GET_DATA("SQL:select ifnull(summa,0) as SOC_fond from bonus_fond where month="+prm('selected_month')+ " and year="+prm('selected_year')+
            " and ist_id=1000 and ist_div="+div_id );
        _$GET_DATA("SQL:select ifnull(sum(summa),0) as SOC_distr from lit_bonus_v0 where month="+prm('selected_month')+ " and year="+prm('selected_year')+
            " and ist_id=1000 and ist_div="+div_id );

        _$GET_DATA("SQL:select ifnull(summa,0) as other_fond from bonus_fond where month="+prm('selected_month')+ " and year="+prm('selected_year')+
            " and ist_id=3000 and ist_div="+div_id );
        _$GET_DATA("SQL:select ifnull(sum(summa),0) as other_distr from lit_bonus_v0 where month="+prm('selected_month')+ " and year="+prm('selected_year')+
            " and ist_id=3000 and ist_div="+div_id );



        _$GET_DATA("SQL:select ifnull(sum(summa),0) as fond_summ_prev from bonus_fond where month<"+prm('selected_month')+ " and year="+prm('selected_year')+
            " and ist_id<100 and ist_div="+div_id );
        _$GET_DATA("SQL:select ifnull(sum(summa),0) as got_fond_prev from lit_bonus_v0 where month<"+prm('selected_month')+ " and year="+prm('selected_year')+
            " and ist_id<100 and ist_div="+div_id );

*/


        var fond_summ = +prm('fond_summ');    
        var got_fond = +prm('got_fond');    
        var jinr_distr = +prm('jinr_distr');    
        got_fond +=jinr_distr;
        var SOC_fond = +prm('SOC_fond');    
        var SOC_distr = +prm('SOC_distr');    
        var SOC_balance = SOC_fond - SOC_distr;    

        var other_fond = +prm('other_fond');    
        var other_distr = +prm('other_distr');    
        var other_balance = other_fond - other_distr;    
      var fond_summ_prev = +prm('fond_summ_prev');    
        var got_fond_prev = +prm('got_fond_prev');    
        var ostatok = fond_summ_prev-got_fond_prev;

        if (got_fond.length == 0 ){
            got_fond = 0;
        }
        if (fond_summ.length == 0 ){
            fond_summ = 0;
        }
        var fond_balance=fond_summ-got_fond;
        var paint;
        paint = ' style="font-size:70%;color:green" ';
        if (fond_balance<0){
            paint = ' style="font-size:70%;color:red" ';
        } 

        c_names[i] ='<span '+paint+'>'+c_names[i]+
           '<br><hr>&nbsp;&nbsp;ФЗП&nbsp;&nbsp;<br>Фонд='+fond_summ+'<br>Расписано='+(fond_summ-fond_balance)+'<br>Остаток='+fond_balance+
           '<br><hr>&nbsp;&nbsp;NICA&nbsp;&nbsp;<br>Фонд='+SOC_fond+'<br>Расписано='+(SOC_fond-SOC_balance)+'<br>Остаток='+SOC_balance+
           '<br><hr>&nbsp;&nbsp;Прочие&nbsp;&nbsp;<br>Фонд='+other_fond+'<br>Расписано='+(other_fond-other_balance)+'<br>Остаток='+other_balance+

            '</span>'


;
    }
    setPrm('c_names',JSON.stringify(c_names));
    div_ids = div_ids.concat(c_ids);
    setPrm('sub_count',c_ids.length*2);
    
    sub_div_table += '<th style="border-right:1px solid black;top: 3em'+paint+'" colspan=2>'+c_names.join('</th><th style="border-right:1px solid black;top: 3em" colspan=2>')+'</th>' ;
    sub_div_table +='</tr></table></div>'
    subdivfonds += '<td>'+sub_div_table+'</td>';
    setPrm('sub_head',div_names);
    setPrm('subdivfonds',subdivfonds);
    setPrm('sub_div_table',sub_div_table);
    
  $JS_}
  $LOG2 ======= HEAD HTML #sub_count# #c_names# #cur_otd_ids# #:tst#<br> ??
  <th colspan=1>  
      <div >
        <span id="#top_name#" class="pt" style="padding:2px;" onclick="
            var htm = this.id;
//            alert($('##fond_sub_#TOP_DIV#').css('display'))
            if ($('##fond_sub_#TOP_DIV#').css('display') == 'none' ){
                this.innerHTML=htm+'^';
            } else {
                this.innerHTML=htm+'>';
            }
            toggleDiv('fond_sub_#TOP_DIV#', 200);

        ">
        #top_name#>
        </span>
    </div>
  </th>  
  
  $LOG2  ======END [fill otdelenie]
[end]

[actual fonds]
    <style>
    .noborder{
        border-right: none;
        border-top: none;
        border-left: none;
        border-right: none;
    }
    .border{
        border-left: 1px black;
        border-right: 1px black;
        border-top: 1px black solid;
        border-right: 1px black solid;
    }
    legend {
        display: block;
        padding-inline-start: 2px;
        padding-inline-end: 2px;
        border-width: initial;
        border-style: none;
        border-color: initial;
        border-image: initial;
    }
    </style>
    <fieldlist>
    <legend style="padding:2px 7px 2px 3px;">
    <span class="pt" style="font-size:140%;padding:2px;" onclick="toggleDiv('actual_fonds', 200);">
    Фонды за #sel_month_text# #selected_year#г
:
    </span>
    </legend>
    <div id=actual_fonds style="font-family: Verdana,Arial,sans-serif;
                    color: #222222;
                    display: all;
                    padding: 0px 0px 0px 20px;"
    >
        <table   border=1 cellpadding=1 cellspacing=0>
        <tr>
            $GET_DATA SQL:select  concat(id,',') as TOP_DIVS from struktura where pid=#LAB_ID# #strflt_h# order by short_name
            $JS var top_divs = prm('TOP_DIVS').split(',');
            $JS var div_ids = [];var div_names='';var tst='';var subdivfonds = '<tr>';
            $LOG2 TOP_DIVS=#TOP_DIVS#<br> ??
            $LOG2 11111===============EXECUTE_LOOP=============<br> ??
            $EXECUTE_LOOP TOP_DIV; #TOP_DIVS#; [fill otdelenie fonds]  
        </tr>
        <tr>
        #subdivfonds#
        </tr>
        </table> </br>
    </div>
    </fieldlist>
[end]

[save input]
    $LOG ===============SAVE                !!!!!!!!!!!!!!!!!!!!!!!!!!!!<br>
    $LOG #data#<br>
    $JS{
        var data=JSON.parse(prm('data'));
        for (i in data){
            _$LOG(2,'i= '+JSON.stringify(i)+'<br>'); ??
            var el=data[i];
            _$LOG(2,JSON.stringify(el)+'<br>'); 
            var name=el["name"];
            var summa=el["value"];
            var desc = name.split('_');
            if (desc.length<3) continue;
            var btype=desc[0].trim();
            var ist_div=desc[1].trim();;
            var tab_n=desc[2].trim();;
            var ist_id=-1;
            if (btype=='fzp'){ist_id=90} 
            if (btype=='fmp'){ist_id=2000} 
            if (btype=='SOC'){ist_id=#SOC_code#} 
            if (btype=='STIMUL'){ist_id=#STIMUL_code#} 
            if (btype=='NHP'){ist_id=#NHP_code#} 
            if (btype=='other'){ist_id=3000} 
            if (btype=='jinr'){ist_id=4000} 
            setPrm('ist_id_t',ist_id);
            setPrm('ist_div_t',ist_div);
            setPrm('tab_n_t',tab_n);
            setPrm('summa_t',summa);
            _$LOG(2,btype+' div='+ist_div+' tabn='+tab_n+' summa'+summa+'<br>'); 
            if ((summa.length==0) | (+summa==0) ){
                _$GET_DATA('check_old');
                if ( +prm('bonus_exist') == 1) {
                _$GET_DATA('deleteRecord');
                }
            } else {
                    _$GET_DATA('updateRecord'); 
            }
        }
    $JS}
[end]
[updateRecord]
    replace lit_bonus_v0
       (tab_n, year,month, ist_id, ist_div, summa, changed_by, comment) 
       values(#tab_n_t#, #year#, #month#, #ist_id_t#, #ist_div_t#, #summa_t#, #USER_ID#, '');
    insert lit_bonus_v0_history    
       (tab_n, year,month, ist_id, ist_div, summa, changed_by, comment) 
       values(#tab_n_t#, #year#, #month#, #ist_id_t#, #ist_div_t#, #summa_t#, #USER_ID#, '');

[end]
[check_old]
    select 1 as bonus_exist from lit_bonus_v0 where tab_n=#tab_n_t# and year=#year#  and month=#month#  and ist_id=#ist_id_t# and ist_div=#ist_div_t#
[end]

[deleteRecord]
    delete from  lit_bonus_v0 where tab_n=#tab_n_t# and year=#year#  and month=#month#  and ist_id=#ist_id_t# and ist_div=#ist_div_t#;
    insert lit_bonus_v0_history    
       (tab_n, year,month, ist_id, ist_div, summa, changed_by, comment) 
       values(#tab_n_t#, #year#, #month#, #ist_id_t#, #ist_div_t#, 0, #USER_ID#, '');
[end]
[get total sotr stavka]
    select count(*) as persons_count,  round(sum(stavka),2) as stavka_count 
    from sotrudniki sotr
    left join oklad on sotr.tab_n=oklad.tab_n 
    $INCLUDE utils.cfg[criteria] 
    and #premii_filter# ??premii_filter
    and #fin_filter# ??fin_filter

    order by #srt# #desc# ??srt
[end]
[total table]
    $GET_DATA [get total sotr stavka]
    <table border=1 cellpadding=5 cellspacing=0>
    </br>
    <tr>
    $LOG2 DATE = year = #year# month=#month# <br>

        $GET_DATA [get Totals]
        <td class="label">
            Количество ставок:
        </td><td>
            #stavka_count#
        </td>
        <td class="label">
            Количество человек:
        </td><td>
            #persons_count#
        </td>

    </tr>
    </table>
[end]


[copyPrevMonth]
    replace lit_bonus_v0 (tab_n,YEAR,MONTH, summa, ist_id, ist_div, changed_by, comment)
    SELECT tab_n, year,month+1 , summa, 90, ist_div,  changed_by, comment FROM 
    (SELECT *, 
    (SELECT case 
                            when (topparent_code=195000 OR topparent_code=189000) then topparent_code
                            when (topparent_code<>195000) AND (topparent_code<>189000) then subtopparent_code
                            end
                             FROM  sotrudniki s WHERE s.tab_n=b.tab_n) AS div_code1

      FROM lit_bonus_v0 b WHERE ist_id=90 and YEAR=#year# AND MONTH=#month#-1) bb
      WHERE div_code1=ist_div and tab_n in (select tab_n
        from sotrudniki sotr
        $INCLUDE utils.cfg[criteria] 
        and #premii_filter# ??premii_filter
        and #fin_filter# ??fin_filter
[end]



[report header]
$SET_PARAMETERS   SOC_code=5000
$SET_PARAMETERS    STIMUL_code=6000
$SET_PARAMETERS    NHP_code=7000

$LOG2  premii_filter  #premii_filter#
$LOG2 btype===================================== #btype#<br>
$GET_DATA [define date]
    $INCLUDE [total table] ??!XL=Y
$INCLUDE [save input] ??SAVE_DATA=Y
$GET_DATA  [copyPrevMonth] ??op=copyPrevMonth
$SET_PARAMETERS disabled=disabled ??!mode=edit

$LOG2 selected_month #selected_month# <br>

$SET_PARAMETERS period=за квартал 
$SET_PARAMETERS period=за месяц   ??month=1|month=2|month=3|month=4|month=5|month=6|month=7|month=8|month=9|month=10|month=11|month=12

$INCLUDE [selected month to text]
$SET_PARAMETERS sotr_num=0
    <style>
    .noborder{
        border-right: none;
        border-top: none;
        border-left: none;
        border-bottom: none;
    }
    .border{
        border-left: 1px black solid;
        border-right: 1px black solid;
        border-top: 1px black solid;
        border-bottom: 1px black solid;
    }
</style>
    <script>
    </script>
    $SET_PARAMETERS pfb_ieto=(195000,189000)
    $SET_PARAMETERS ved_vsego=0
    $INCLUDE [get istmap]

    $JS{
        var tmp1=prm('premii_filter');
        var tmp2 = '';
        if (tmp1.toLowerCase().indexOf('sotr.subtopparent_name')>-1){
            tmp1 = tmp1.replace('sotr.subTopParent_name','short_name');
            tmp2 = ' and id in (select id from struktura where '+tmp1+')';
            tmp1 = ' and id in (select pid from struktura where '+tmp1+')';
            

        }
        if (tmp1.toLowerCase().indexOf('sotr.topparent_name')>-1){
            tmp1 = tmp1.replace('sotr.TopParent_name','short_name');
            tmp2 = '';
            tmp1 = ' and id in (select id from struktura where '+tmp1+')';

        }


        _$LOG(2,'-=-=-=-=-=-'+tmp1+' '+tmp1.length+'<br>')
        if (tmp1.length>0) {
        }
//       tmp1 = ' and id = 110000';
        setPrm('strflt_h',tmp1);
        setPrm('strflt_s',tmp2);
        
    $JS}
    
    $LOG2  lookup_date!!!!!!  #lookup_date# #selected_month# #selected_year#

    $INCLUDE [actual fonds] ??
    <table class="tlist tgreen" cellspacing=0" 
       style='font-family: "Times New Roman", Times, serif; font-size:120%'  ??XL=Y
       border=1 ??!XL=Y
       border=0 ??XL=Y
    >
    $INCLUDE [vedomost header] ??XL=Y
    $IF XL=Y&btype=EXPORT1C
        $JS{
            var exportjson = '';
        $JS}
    $EIF


    <tr>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td> ??XL=Y
        <td class=border style="text-align:center">&nbsp;№&nbsp;</td> 
        
        <th 
                class="border srh" ??!XL=Y
                class="border" ??XL=Y
            sr="sotr.tab_n">Таб.№</th>
        <th 
                class="border srh" ??!XL=Y
                class="border" ??XL=Y
        sr="sotr.FIO">ФИО</th>
        <th  class="border"   sr="sotr.TopParent_name">Отдел</th> 
        <th  class="border" >сектор</th> ??!btype
        <th  class="border" >Дней<br>отпуска!XL=Y </th> ??construct
    $IF !btype
        <th class=border >ФЗП<br>(#period#)</th> 
        <th class=border>ФМП<br>(#period#)</th> 
        <th class=border>СоцБыт<br>(#period#)</th> 
        <th class=border>Стимул.<br>(#period#)</th> 
        <th class=border>НХП<br>(#period#)</th> 
        <th class=border>Сумма<br>(#period#)</th> 
    $ELSE
        <th class=border >ФЗП<br>(#period#)</th>  ??btype=FZP
        <th class=border>ФМП<br>(#period#)</th> ??btype=FMP
        <th class=border>СоцБыт<br>(#period#)</th> ??btype=SOC
        <th class=border>Стимул.<br>(#period#)</th> ??btype=STIMUL
        <th class=border>НХП<br>(#period#)</th> ??btype=NHP
        <th class=border>Разовые<br>(#period#)</th> ??btype=other__

    $EIF
    </tr>
    $INCLUDE [selection summary] ? !XL=Y  ??
    $SET_PARAMETERS num_sotr=1
    $LOG2 ====================================== begin sotrudniki premii_filter #premii_filter# =================================<br>
    $JS{ 
        var export_json = '';
    $JS}
    $USE_DB 1C
       $GET_DATA [get otpusk]
    $USE_DB
    
[end]
[get otpusk]
   seorder by o.КодСотрудника;lect * from [1c8_2].[Отпуска] o 
      where 
        (month(o.НачалоОтпуска) = #selected_month# or month(o.ОкончаниеОтпуска)  = #selected_month# )
        and (year(o.НачалоОтпуска) = #selected_year# or year(o.ОкончаниеОтпуска)  = #selected_yearh# )
        order by o.КодСотрудника;
[end]

[item]
    $LOG2 ===================================================================<br>
    $LOG2 ==========================#FIO#=#tab_n# ========================================<br>
    $LOG2 ===================================================================<br>
    $LOG2 fzp_bonus_month_all=#fzp_bonus_month_all# <br>
    $SET_PARAMETERS div_code=#topparent_code#
    $SET_PARAMETERS fzp_bonus_year=;fmp_bonus_year=;SOC_bonus_year=;other_bonus_year=;STIMUL_bonus_year=;NHP_bonus_year=;
    $SET_PARAMETERS fzp_bonus_month=;fmp_bonus_month=;SOC_bonus_month=;STIMUL_bonus_month=;NHP_bonus_month=;other_fzp_bonus_month=;other_SOC_bonus_month=;other_bonus_month=;other_STIMUL_bonus_month=;other_NHP_bonus_month=
    $SET_PARAMETERS bonus_month=;fzp_bonus_other_month=
    $SET_PARAMETERS bonus_year=
    $GET_DATA SQL:select concat(div_code," " ,summa," ",i.id,",") as bonus_month from bonus b left join istochniki i on b.ist_id=i.id where tab_n=#tab_n# and month=#selected_month# and year = #selected_year# order by ist_id

    $LOG2 check month bonus:#bonus_month# <br>??
    $JS var bonusMonth = "#bonus_month#";
    $JS var bonusYear = "#bonus_year#";
    $JS var topparent_code = "#topparent_code#";

    $GET_DATA SQL:select sum(summa) as other_fzp_bonus_month from lit_bonus_v0  where tab_n=#tab_n# and year = #selected_year# and  ist_id<100 and ist_div!=#div_code# and month=#selected_month# 
    $GET_DATA SQL:select sum(summa) as fzp_bonus_other_month from lit_bonus_v0  where tab_n=#tab_n# and year = #selected_year# and ist_id<100 and  month=#selected_month# and ist_div<>#div_code#
    $GET_DATA SQL:select sum(summa) as fzp_bonus_month from lit_bonus_v0  where tab_n=#tab_n# and year = #selected_year# and ist_id<100  and  month=#selected_month# and ist_div=#div_code#
    $GET_DATA SQL:select sum(summa) as fmp_bonus_month from lit_bonus_v0  where tab_n=#tab_n# and year = #selected_year# and  ist_id=2000  and month=#selected_month#

    $GET_DATA SQL:select sum(summa) as SOC_bonus_month from lit_bonus_v0        where tab_n=#tab_n# and year = #selected_year# and  ist_id=#SOC_code#  and month=#selected_month# and ist_div=#div_code#
    $GET_DATA SQL:select sum(summa) as other_SOC_bonus_month from lit_bonus_v0  where tab_n=#tab_n# and year = #selected_year# and  ist_id=#SOC_code#  and month=#selected_month# and ist_div!=#div_code#
    
    $GET_DATA SQL:select sum(summa) as STIMUL_bonus_month from lit_bonus_v0        where tab_n=#tab_n# and year = #selected_year# and  ist_id=#STIMUL_code#  and month=#selected_month# and ist_div=#div_code#
    $GET_DATA SQL:select sum(summa) as other_STIMUL_bonus_month from lit_bonus_v0  where tab_n=#tab_n# and year = #selected_year# and  ist_id=#STIMUL_code#  and month=#selected_month# and ist_div!=#div_code#

    $GET_DATA SQL:select sum(summa) as NHP_bonus_month from lit_bonus_v0        where tab_n=#tab_n# and year = #selected_year# and  ist_id=#NHP_code#  and month=#selected_month# and ist_div=#div_code#
    $GET_DATA SQL:select sum(summa) as other_NHP_bonus_month from lit_bonus_v0  where tab_n=#tab_n# and year = #selected_year# and  ist_id=#NHP_code#  and month=#selected_month# and ist_div!=#div_code#


    $GET_DATA SQL:select sum(summa) as other_bonus_month from lit_bonus_v0  where tab_n=#tab_n# and year = #selected_year# and  ist_id=3000  and month=#selected_month#  and ist_div=#div_code#
    $GET_DATA SQL:select sum(summa) as other_other_bonus_month from lit_bonus_v0  where tab_n=#tab_n# and year = #selected_year# and  ist_id=3000  and month=#selected_month# and ist_div!=#div_code#



    $GET_DATA SQL:select sum(summa) as fzp_bonus_year from lit_bonus_v0  where tab_n=#tab_n# and year = #selected_year# and ist_id<100 
    $GET_DATA SQL:select sum(summa) as fmp_bonus_year from lit_bonus_v0  where tab_n=#tab_n# and year = #selected_year#  and ist_id=2000 
    $GET_DATA SQL:select sum(summa) as SOC_bonus_year from lit_bonus_v0  where tab_n=#tab_n# and year = #selected_year#  and ist_id=#SOC_code#
    $GET_DATA SQL:select sum(summa) as STIMUL_bonus_year from lit_bonus_v0  where tab_n=#tab_n# and year = #selected_year#  and ist_id=#STIMUL_code#
    $GET_DATA SQL:select sum(summa) as NHP_bonus_year from lit_bonus_v0  where tab_n=#tab_n# and year = #selected_year#  and ist_id=#NHP_code#
    $GET_DATA SQL:select sum(summa) as other_bonus_year from lit_bonus_v0  where tab_n=#tab_n# and year = #selected_year# and  ist_id=3000  

$SET_PARAMETERS  fzp_bonus_month_full=;fmp_bonus_month_full=;SOC_bonus_month_full=;STIMUL_bonus_month_full=;NHP_bonus_month_full=;other_bonus_month_full=
    $GET_DATA SQL:select sum(summa) as fzp_bonus_month_full from lit_bonus_v0  where tab_n=#tab_n# and year = #selected_year# and ist_id<100 and   month=#selected_month#
    $GET_DATA SQL:select sum(summa) as fmp_bonus_month_full from lit_bonus_v0  where tab_n=#tab_n# and year = #selected_year# and  ist_id=2000  and month=#selected_month#
    $GET_DATA SQL:select sum(summa) as SOC_bonus_month_full from lit_bonus_v0  where tab_n=#tab_n# and year = #selected_year# and  ist_id=#SOC_code#  and month=#selected_month#
    $GET_DATA SQL:select sum(summa) as STIMUL_bonus_month_full from lit_bonus_v0  where tab_n=#tab_n# and year = #selected_year# and  ist_id=#STIMUL_code#  and month=#selected_month#
    $GET_DATA SQL:select sum(summa) as NHP_bonus_month_full from lit_bonus_v0  where tab_n=#tab_n# and year = #selected_year# and  ist_id=#NHP_code#  and month=#selected_month#
    
$GET_DATA SQL:select sum(summa) as other_bonus_month_full from lit_bonus_v0  where tab_n=#tab_n# and year = #selected_year# and  ist_id=3000  and month=#selected_month#

    $IF btype
       $BREAK ??btype=FZP&!fzp_bonus_month_full
       $BREAK ??btype=FMP&!fmp_bonus_month_full
       $BREAK ??btype=SOC&!SOC_bonus_month_full
       $BREAK ??btype=STIMUL&!STIMUL_bonus_month_full
       $BREAK ??btype=NHP&!NHP_bonus_month_full
       $BREAK ??btype=OTHER&!other_bonus_month_full
       $LOG2 btype=#btype# <br>
       $GET_DATA SQL:select #ved_vsego#+#fzp_bonus_month_full# as ved_vsego ??btype=FZP
       $GET_DATA SQL:select #ved_vsego#+#fmp_bonus_month_full# as ved_vsego ??btype=FMP
       $GET_DATA SQL:select #ved_vsego#+#SOC_bonus_month_full# as ved_vsego ??btype=SOC
       $GET_DATA SQL:select #ved_vsego#+#STIMUL_bonus_month_full# as ved_vsego ??btype=STIMUL
       $GET_DATA SQL:select #ved_vsego#+#NHP_bonus_month_full# as ved_vsego ??btype=NHP
       $GET_DATA SQL:select #ved_vsego#+#other_bonus_month_full# as ved_vsego ??btype=OTHER
       $GET_DATA SQL:select #sotr_num#+1 as sotr_num
    $EIF


    $IF other_SOC_bonus_month
        $SET_PARAMETERS SOC_bgcolor= bgcolor=FF8080 
    $ELSE
        $SET_PARAMETERS SOC_bgcolor=
    $EIF
    $IF other_fzp_bonus_month
        $SET_PARAMETERS fzp_bgcolor= bgcolor=FF8080 
    $ELSE
        $SET_PARAMETERS fzp_bgcolor=
    $EIF

    $SET_PARAMETERS bonus_month=;bonus_year;
    $GET_DATA SQL:select sum(summa) as bonus_month from lit_bonus_v0 where tab_n=#tab_n# and month=#selected_month# and year = #selected_year# order by ist_id
    $GET_DATA SQL:select sum(summa) as bonus_year from lit_bonus_v0 where tab_n=#tab_n# and year = #selected_year# order by ist_id
 
    ++++++++++++++++++ Строка таблицы - 1 документ +++++++++++++++++++++ ??
    <tr         changed=N
        class="pt oddRow" ??oddRow=1
        class="pt" ??!oddRow=1
        style="
            color:red ??dismissed=Y
            color:black ??dismissed=N
            ;
        background-color:##6e85fa??contract_type=1
        background-color:##ebcb75??contract_type=D
        background-color:##00ff55??contract_type=S
        "

    >
    <td class=noborder >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td> ??XL=Y
    <td class=border style="text-align:right">&nbsp;&nbsp;#num_sotr#&nbsp;</td> ??XL=Y
    <td class=border style="text-align:right">&nbsp;&nbsp;#currentRow#&nbsp;</td> ??!XL=Y
    $GET_DATA SQL:select #num_sotr#+1 as num_sotr ??XL=Y
    <td class=border>&nbsp;#tab_n#&nbsp;</td> 
    $JS{
        var fio = getFio(prm("FIO"));
        while (fio.length<40){
            fio = fio+'&nbsp;';
        }
        setPrm('fio',fio)
    $JS}
    <td  class=border>#fio#</td> 
    <td  class=border>#topparent_name#</td> 
    $IF !btype
        <td  class=border>&nbsp;#subtopparent_name#&nbsp;</td>
    $EIF
     <th  class="border" >Дней<br>отпуска!XL=Y </th> ??construct

    $JS{
        var div_code=prm('div_code');
        var fzpOn= 'onClick="ShowDialog(true); AjaxCall(\'popupCont\', \'c=edit/lit_bonus_v05&FIO='+getFio(prm("FIO"))+'&tab_n='+prm('tab_n');
        fmpOn   =fzpOn+ '&month='+prm('selected_month')+'&year='+prm('selected_year')+'&btype=fmp&ist_div='+div_code+'\', true);"';
        SOCOn  =fzpOn+ '&month='+prm('selected_month')+'&year='+prm('selected_year')+'&show_other=Y&btype=SOC&ist_div='+div_code+'\', true);"';
        STIMULOn  =fzpOn+ '&month='+prm('selected_month')+'&year='+prm('selected_year')+'&show_other=Y&btype=STIMUL&ist_div='+div_code+'\', true);"';
        NHPOn  =fzpOn+ '&month='+prm('selected_month')+'&year='+prm('selected_year')+'&show_other=Y&btype=NHP&ist_div='+div_code+'\', true);"';
        otherOn =fzpOn+ '&month='+prm('selected_month')+'&year='+prm('selected_year')+'&show_other=Y&btype=other&ist_div='+div_code+'\', true);"';
        fzpOn += '&month='+prm('selected_month')+'&year='+prm('selected_year')+'&show_other=Y&btype=fzp&ist_div='+div_code+'\', true);"';
        setPrm('fzpOn',fzpOn);
        setPrm('fmpOn',fmpOn);
        setPrm('SOCOn',SOCOn);
        setPrm('STIMULOn',STIMULOn);
        setPrm('NHPOn',NHPOn);
        setPrm('otherOn',otherOn);
//        _$LOG(2,fzpOn+'<br>'); 
    $JS}
    $IF !btype&!XL
        <td class=check_change  #fzp_bgcolor#> 
           <input class=inputBonus #disabled#  name="fzp_#div_code#_#tab_n#" value="#fzp_bonus_month#" size="6">
           <i style="font-size:150%" #fzpOn# class="fas fa-check-circle" ">
        
           #fzp_bonus_other_month#
            </i>
        </td>
        <td class=check_change  #fmp_bgcolor#>
           <input class=inputBonus #disabled# name="fmp_#div_code#_#tab_n#" value="#fmp_bonus_month#" size="6">
           <i style="font-size:150%" #fmpOn# class="fas fa-check-circle "></i>

           
        </td>
        <td class=check_change   #SOC_bgcolor# >
           <input class=inputBonus #disabled# name="SOC_#div_code#_#tab_n#" value="#SOC_bonus_month#" size="6">
           <i style="font-size:150%" #SOCOn# class="fas fa-check-circle "></i>
            
        </td>
        <td class=check_change   #STIMUL_bgcolor# >
           <input class=inputBonus #disabled# name="STIMUL_#div_code#_#tab_n#" value="#STIMUL_bonus_month#" size="6">
           <i style="font-size:150%" #STIMULOn# class="fas fa-check-circle "></i>
            
        </td>
        <td class=check_change   #NHP_bgcolor# >
           <input class=inputBonus #disabled# name="NHP_#div_code#_#tab_n#" value="#NHP_bonus_month#" size="6">
           <i style="font-size:150%" #NHPOn# class="fas fa-check-circle "></i>
        </td>
        <td  #other_bgcolor# >                                                                                           ??
           <input class=inputBonus #disabled# name="other_#div_code#_#tab_n#" value="#other_bonus_month#" size="6">       ??
           <i style="font-size:150%" #otherOn# class="fas fa-check-circle ">                                    ??
           #other_other_bonus_month#    ??
           </i> ??
        </td> ??

        <td bgcolor=d0d0d0>#bonus_month#</td>
        <td >#fzp_bonus_year#</td> ??
        <td >#fmp_bonus_year#</td> ??
        <td >#SOC_bonus_year#</td> ??
        <td >#other_bonus_year#</td> ??

        <td bgcolor=d0d0d0>#bonus_year#</td> ??
    $EIF

    $IF btype
        <td class=border>#fzp_bonus_month_full#</td> ??btype=FZP&fzp_bonus_month_full
        <td class=border>#fmp_bonus_month_full#</td> ??btype=FMP&fmp_bonus_month_full
        <td class=border>#SOC_bonus_month_full#</td> ??btype=SOC&SOC_bonus_month_full
        <td class=border>#STIMUL_bonus_month_full#</td> ??btype=STIMUL&STIMUL_bonus_month_full
        <td class=border>#NHP_bonus_month_full#</td> ??btype=NHP&NHP_bonus_month_full
        <td class=border>#other_bonus_month_full#</td> ??btype=OTHER&other_bonus_month_full
        $INCLUDE [fill export json] ??btype=EXPORT1C
    $EIF
    $IF XL&!btype 
        <td class=border>#fzp_bonus_month_full#</td> 
        <td class=border>#fmp_bonus_month_full#</td> 
        <td class=border>#SOC_bonus_month_full#</td> 
        <td class=border>#STIMUL_bonus_month_full#</td>
        <td class=border>#NHP_bonus_month_full#</td> 
        <td class=border>#bonus_month#</td>
    $EIF

    </tr>
[end]
[fill export json]
        $JS{ 
                if ( export_json.length >0 )
                    {
                        export_json +=', '
                    };
                export_json +='{"tab_n":"#tab_n#", "fzp":"#fzp_bonus_month_full#", "fmp":"#fmp_bonus_month_full#", "fzp":"#SOC_bonus_month_full#", "other":"#other_bonus_month_full#"}'
        $JS}
[end]

[selection summary]
        $SET_PARAMETERS other_bonus_month_all=0
        $SET_PARAMETERS other_bonus_year_all=0

        $GET_DATA [get Totals]
            <tr>
                
                <td colspan=5 style="text-align:center;font-size:100%;color:blue;background:LightCyan">Cуммарно по выборке</td>
                <td style="color:blue;background:LightCyan;" >
                    Отдел:#fzp_bonus_month_all# <br>
                    Внешние:#other_fzp_bonus_month_all# 
                    
                </td>
                <td style="color:blue;background:LightCyan;" >
                    #fmp_bonus_month_all# 
                </td>
                <td style="color:blue;background:LightCyan;" >
                    Отдел:#SOC_bonus_month_all# <br>
                    Внешние:#other_SOC_bonus_month_all# 
                </td>
                <td style="color:blue;background:LightCyan;" >
                    Отдел: #other_bonus_month_all# <br>
                    Внешние:#other_other_bonus_month_all# 
                </td>
                $GET_DATA SQL:select #other_bonus_month_all# + #SOC_bonus_month_all# +  #fmp_bonus_month_all#   +  #fzp_bonus_month_all#+  #other_fzp_bonus_month_all#  as summ_bonus_month_all

                <td style="color:blue;background:LightCyan;" >
                    #summ_bonus_month_all# 
                </td>
                <td style="color:blue;background:LightCyan;" >
                    #fzp_bonus_year_all# 
                </td>
                <td style="color:blue;background:LightCyan;" >
                    #fmp_bonus_year_all# 
                </td>
                <td style="color:blue;background:LightCyan;" >
                    #SOC_bonus_year_all# 
                </td>
                <td style="color:blue;background:LightCyan;" >
                    #other_bonus_year_all# 
                </td>
                $GET_DATA SQL:select #other_bonus_year_all# + #SOC_bonus_year_all# +  #fmp_bonus_year_all#   +  #fzp_bonus_year_all#  as summ_bonus_year_all
                <td style="color:blue;background:LightCyan;" >
                    #summ_bonus_year_all# 
                </td>

            </tr>
[end]

[sum year bonus]
    select #other_bonus_year_all# + #SOC_bonus_year_all# +  #fmp_bonus_year_all#   +  #fzp_bonus_year_all#  as summ_bonus_year_all
[end]

[get Totals]
    Премии ФЗП ??
    select 
       sum( (select ifnull(sum(summa),0)  from lit_bonus_v0  bns
        where  year = #selected_year# and ist_id<100 
        and ( 
        (ist_div=topparent_code and topparent_code in (195000,189000))
        or
        (ist_div=subtopparent_code and not topparent_code in (195000,189000))
        )
        and month=#selected_month#
        and bns.tab_n = sotr.tab_n)) as fzp_bonus_month_all 
    from sotrudniki sotr
    $INCLUDE utils.cfg[criteria] 
    and #premii_filter# ??premii_filter
    ;
    Премии ФЗП из других отделов??
    select 
       sum( (select ifnull(sum(summa),0)  from lit_bonus_v0  bns
        where  year = #selected_year# and ist_id<100 and 
        (
        (ist_div<>topparent_code and topparent_code in (195000,189000))
        or
        (ist_div<>subtopparent_code and not topparent_code in (195000,189000))
        )
        and month=#selected_month#
        and bns.tab_n = sotr.tab_n)) as other_fzp_bonus_month_all 
    from sotrudniki sotr
    $INCLUDE utils.cfg[criteria] 
    and #premii_filter# ??premii_filter
    ;
    Премии ФМП ??
    select 
       sum( (select ifnull(sum(summa),0)  from lit_bonus_v0  bns
        where  year = #selected_year# and ist_id=2000  and month=#selected_month# 
        and  ( ??
        (ist_div=topparent_code and topparent_code in (195000,189000)) ??
        or ??
        (ist_div=subtopparent_code and not topparent_code in (195000,189000)) ??
        ) ??

        and bns.tab_n = sotr.tab_n)) as fmp_bonus_month_all 
    from sotrudniki sotr
    $INCLUDE utils.cfg[criteria] 
    and #premii_filter# ??premii_filter
    ;

=========================    Премии NICA ??
Родной отдел ??
    select 
       sum( (select ifnull(sum(summa),0)  from lit_bonus_v0  bns
        where  year = #selected_year# and ist_id=1000 
        and ( 
        (ist_div=topparent_code and topparent_code in (195000,189000))
        or
        (ist_div=subtopparent_code and not topparent_code in (195000,189000))
        )
        and month=#selected_month#
        and bns.tab_n = sotr.tab_n)) as SOC_bonus_month_all 
    from sotrudniki sotr
    $INCLUDE utils.cfg[criteria] 
    and #premii_filter# ??premii_filter
    ;
    Премии NICA из других отделов??
    select 
       sum( (select ifnull(sum(summa),0)  from lit_bonus_v0  bns
        where  year = #selected_year# and ist_id=1000 and 
        (
        (ist_div<>topparent_code and topparent_code in (195000,189000))
        or
        (ist_div<>subtopparent_code and not topparent_code in (195000,189000))
        )
        and month=#selected_month#
        and bns.tab_n = sotr.tab_n)) as other_SOC_bonus_month_all 
    from sotrudniki sotr
    $INCLUDE utils.cfg[criteria] 
    and #premii_filter# ??premii_filter
    ;


=========================    Премии ПРОЧЕЕ ??
Родной отдел ??
    select 
       sum( (select ifnull(sum(summa),0)  from lit_bonus_v0  bns
        where  year = #selected_year# and ist_id=3000 
        and ( 
        (ist_div=topparent_code and topparent_code in (195000,189000))
        or
        (ist_div=subtopparent_code and not topparent_code in (195000,189000))
        )
        and month=#selected_month#
        and bns.tab_n = sotr.tab_n)) as other_bonus_month_all 
    from sotrudniki sotr
    $INCLUDE utils.cfg[criteria] 
    and #premii_filter# ??premii_filter
    ;
    Премии ПРОЧЕЕ из других отделов??
    select 
       sum( (select ifnull(sum(summa),0)  from lit_bonus_v0  bns
        where  year = #selected_year# and ist_id=3000 and 
        (
        (ist_div<>topparent_code and topparent_code in (195000,189000))
        or
        (ist_div<>subtopparent_code and not topparent_code in (195000,189000))
        )
        and month=#selected_month#
        and bns.tab_n = sotr.tab_n)) as other_other_bonus_month_all 
    from sotrudniki sotr
    $INCLUDE utils.cfg[criteria] 
    and #premii_filter# ??premii_filter
    ;



===========================================   YEAR??
    Премии ФЗП ??
    select 
       sum( (select ifnull(sum(summa),0)  from lit_bonus_v0  bns
        where  year = #selected_year# and ist_id<100 
        and bns.tab_n = sotr.tab_n)) as fzp_bonus_year_all 
    from sotrudniki sotr
    $INCLUDE utils.cfg[criteria] 
    and #premii_filter# ??premii_filter
    ;
    Премии ФЗП другиз отделов ??
    select 
       sum( (select ifnull(sum(summa),0)  from lit_bonus_v0  bns
        where  year = #selected_year# and ist_id<100 and ist_div<>subtopparent_code  and
        (
        (ist_div<>topparent_code and topparent_code in (195000,189000))
        or
        (ist_div<>subtopparent_code and not topparent_code in (195000,189000))
        )

        and bns.tab_n = sotr.tab_n)) as other_bonus_year_all 
    from sotrudniki sotr
    $INCLUDE utils.cfg[criteria] 
    and #premii_filter# ??premii_filter
    ;
    Премии ФМП ??
    select 
       sum( (select ifnull(sum(summa),0)  from lit_bonus_v0 bns
        where  year = #selected_year# and ist_id=2000  
        and bns.tab_n = sotr.tab_n)) as fmp_bonus_year_all 
    from sotrudniki sotr
    $INCLUDE utils.cfg[criteria] 
    and #premii_filter# ??premii_filter
    ;
    Премии NICA ??
    select 
       sum( (select ifnull(sum(summa),0)  from lit_bonus_v0  bns
        where  year = #selected_year# and ist_id=1000 
        and bns.tab_n = sotr.tab_n)) as SOC_bonus_year_all 
    from sotrudniki sotr
    $INCLUDE utils.cfg[criteria] 
    and #premii_filter# ??premii_filter
    ;

    Премии ПРОЧЕЕ ??
    select 
       sum( (select ifnull(sum(summa),0)  from lit_bonus_v0  bns
        where  year = #selected_year# and ist_id=3000 
        and bns.tab_n = sotr.tab_n)) as other_bonus_year_all 
    from sotrudniki sotr
    $INCLUDE utils.cfg[criteria] 
    and #premii_filter# ??premii_filter
    ;


[end]


***************************** Шаблон SQL запроса ***************************
[selected month to text]
    $SET_PARAMETERS sel_month_text=январь ??selected_month=1
    $SET_PARAMETERS sel_month_text=февраль ??selected_month=2
    $SET_PARAMETERS sel_month_text=март ??selected_month=3
    $SET_PARAMETERS sel_month_text=апрель ??selected_month=4
    $SET_PARAMETERS sel_month_text=май ??selected_month=5
    $SET_PARAMETERS sel_month_text=июнь ??selected_month=6
    $SET_PARAMETERS sel_month_text=июль ??selected_month=7
    $SET_PARAMETERS sel_month_text=август ??selected_month=8
    $SET_PARAMETERS sel_month_text=сентябрь ??selected_month=9
    $SET_PARAMETERS sel_month_text=октябрь ??selected_month=10
    $SET_PARAMETERS sel_month_text=ноябрь ??selected_month=11
    $SET_PARAMETERS sel_month_text=декабрь ??selected_month=12
    $SET_PARAMETERS sel_month_text=I квартал ??selected_month=101
    $SET_PARAMETERS sel_month_text=II квартал ??selected_month=102
    $SET_PARAMETERS sel_month_text=III квартал ??selected_month=103
    $SET_PARAMETERS sel_month_text=IV квартал ??selected_month=104
[end]
[define date]
    $IF month|year
        $SET_PARAMETERS tmp_month = #month#
        $SET_PARAMETERS tmp_year = #year#
    $ELSE 
        $SET_PARAMETERS tmp_month = month(now())
        $SET_PARAMETERS tmp_year = year(now()) 
    $EIF
    select #tmp_month# as selected_month;
    select #tmp_year# as  selected_year;
[end]


[SQL]
    select 
        case 
            when sotr.contract='-' then ''
            when sotr.contract='Cremlin+' then '1'
            when sotr.contract='Немецкий договор' then 'D'
            when sotr.contract='Специальные премии' then 'S'
            ELSE ''
        END AS contract_type,
        sotr.person_id, sotr.tab_n , 
        (select short_name from struktura where id =  topparent_code) as topparent_name, 
        (select short_name from struktura where id =  subtopparent_code) as subtopparent_name,
        sotr.topparent_code,sotr.subtopparent_code, sotr.FIO, sotr.otdel, sotr.post
    , sotr.division, sotr.category  
    ,case
         when  (ifnull(sotr.DataUvolen-CURRENT_DATE,1)<0)   then 'Y'
    else 'N' end as dismissed
    from sotrudniki sotr
    $INCLUDE utils.cfg[criteria] 
    and #premii_filter# ??premii_filter
    and #fin_filter# ??fin_filter
    order by #srt# #desc# ??srt&!XL=Y
    $LOG2 premii_filter #premii_filter#
    $IF XL=Y
        $SET_PARAMETERS order=order by sotr.topparent_name,  sotr.FIO 
      #order#
    $EIF
[end]


[savejs]
   +++++++++++++++++++++++++++++++++++++++++++++++ savefile_js ++++++++++++++++++++++++++++++++++++++++++++++
   #savefile_js#
   +++++++++++++++++++++++++++++++++++++++++++++++ savefile_js ++++++++++++++++++++++++++++++++++++++++++++++
[end]

[report footer]
    $LOG2 btype===================================== #btype#<br>
   $INCLUDE [savejs] ??btype=EXPORT1C
    <script>
        var cb = $('##modebox');
        var editMode = cb.prop('checked');
        if ( editMode ) {
            cb.val('edit');
            $('.inputBonus').removeAttr('disabled');
        } else {
            cb.val('view');
            $('.inputBonus').attr('disabled','disabled');
        }
    </script>

    $IF XL=Y
        $INCLUDE [vedomost footer] 
    $ELSE
        $SET_PARAMETERS NumTableCols=7;

        <tr><td colspan=#NumTableCols# class="pager last">
        $INCLUDE dat/common.dat[rpp]  ??!NumTableRows=0
        <input type=hidden name="rpp" value="#rpp#"> ??NumTableRows=0
        </td></tr>
    $EIF
    </table>
    $IF !XL=Y
        <script type="text/javascript">
            showSrt("#srt#","sup"); ??!desc
            showSrt("#srt#","sdown"); ??desc

        </script>
    $EIF
<script>
  debugger;
  updateInterface();
</script>
<script>
    $(".check_change").on("change", function(event) {
        this.parentNode.setAttribute("changed",'Y');
        this.parentNode.style.color = '##FF0000';
    });
    $(".check_change").on("keyup", function(event) {
        this.parentNode.setAttribute("changed",'Y');
        this.parentNode.classList.add("changed");
    });
</script>

[end]

[vedomost header]
    <tr>
        <td colspan=3   style="border: none">
        </td>
        <td colspan=3  style="border: none;text-align:right">
            п.п.1.5 Приложение №1
        </td>
    </tr>
    <tr>
        <td colspan=3  style="border: none">
        </td>
        <td colspan=3  style="border: none;text-align:right">
                    к Положению по бухгалтерскому
        </td>
    </tr>
    <tr>
        <td colspan=3  style="border: none">
        </td>
        <td colspan=3  style="border: none;text-align:right">
            и налоговому учету"Учетная политика"
        </td>
    </tr>
    <tr>
        <td colspan=2  style="border: none">
        </td>
        <td colspan=4  style="border: none;text-align:right">
            "УТВЕРЖДАЮ"
        </td>
    </tr>
    <tr>
        <td colspan=2  style="border: none">
        </td>
        <td colspan=4  style="border: none;text-align:right">
            Директор ЛИТ
        </td>
    </tr>
    <tr>
        <td colspan=2  style="border: none">
        </td>
        <td colspan=4  style="border: none;text-align:right">
         &nbsp
        </td>
    </tr>
    <tr>
        <td colspan=2  style="border: none">
        </td>
        <td colspan=4  style="border: none;text-align:right">
         _____________С.В. Шматов

        </td>
    </tr>
    <tr>
        <td colspan=2  style="border: none">
        </td>
        <td colspan=4  style="border: none">
         &nbsp
        </td>
    </tr>

    <tr>
        <td colspan=2  style="border: none">
        </td>
        <td colspan=4  style="border: none;text-align:right">
        "____"____________ #:(new Date()).getUTCFullYear().toFixed(0)#г
        </td>
    </tr>
    <tr>
        <td colspan=3  style="border: none">
        </td>
        <td colspan=3  style="border: none">
         &nbsp
        </td>
    </tr>
    <tr>
    <td style="border: none;text-align:center"></td>
        <td colspan=5 style="border: none;text-align:center">
         ВЕДОМОСТЬ
        </td>
    </tr>
        $INCLUDE [selected month to text]
      <td style="border: none;text-align:center"></td>
        <td colspan=5  style="border: none;text-align:center">
            за #sel_month_text# #selected_year#г
        </td>
    </tr>
    <tr>
        <td style="border: none;text-align:center"></td>
        

        <td colspan=5  style="border: none;text-align:center">
            на выплату премии сотрудникам ЛИТ за выполненные работы <br> из  
       ФЗП ??btype=FZP
       ФМП ??btype=FMP
       НХП ??btype=NHP
       Соц.Быт. фонда ??btype=SOC
       фонда Стимулирования ??btype=STIMUL
       НХП ??btype=NHP
       ПРОЧЕЕ ??btype=OTHER
            МЛИТ				
        </td>
    </tr>
    <tr>
        <td colspan=3  style="border: none">
        </td>
        <td colspan=3  style="border: none">
         &nbsp
        </td>
    </tr>

[end]
[vedomost footer]

    <tr>
        <td colspan=4  style="border: none">
        </td>
        
        <td style="border: none;text-align:left">
            Итого
        </td>
        <td   style="border: none;text-align:left">
         #ved_vsego#
         &nbsp
        </td>
    </tr>
<tr><td>&nbsp;</td></tr>

<tr><td>&nbsp;</td></tr>
    <tr>
        <td  tyle="border: none">
        </td>
        <td colspan=4  style="border: none;text-align:left">
            Старший экономист 
        </td>
        <td  tyle="border: none">
        &nbsp;
        О.Ю. Румянцева
        </td>

    </tr>
    <tr>
        <td colspan-6>&nbsp;</td>
    </tr>
    <tr>
        <td   style="border: none">
        </td>
        <td colspan=4  style="border: none;text-align:left">
            Главный бухгалтер ОИЯИ
        </td>
        <td   style="border: none;text-align:right">
        &nbsp;
         Е.Г. Кутейникова 
        </td>
    </tr>
[end]
